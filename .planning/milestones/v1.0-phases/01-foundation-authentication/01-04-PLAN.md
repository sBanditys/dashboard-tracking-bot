---
phase: 01-foundation-authentication
plan: 04
type: execute
wave: 3
depends_on: ["01-03"]
files_modified:
  - src/app/(dashboard)/layout.tsx
  - src/app/(dashboard)/page.tsx
  - src/app/(dashboard)/loading.tsx
  - src/components/layout/sidebar.tsx
  - src/components/layout/topbar.tsx
  - src/components/layout/mobile-drawer.tsx
  - src/components/layout/breadcrumbs.tsx
  - src/components/layout/user-menu.tsx
  - src/components/theme-toggle.tsx
  - src/components/ui/skeleton.tsx
  - src/components/ui/button.tsx
  - src/hooks/use-mobile.ts
autonomous: true

must_haves:
  truths:
    - "Dashboard displays sidebar on desktop (always expanded)"
    - "Dashboard displays top bar with user avatar and menu"
    - "Mobile view shows hamburger menu that opens slide-out drawer"
    - "User can toggle between dark and light mode"
    - "User can log out from user menu dropdown"
    - "Page shows loading skeleton during data fetches"
    - "Breadcrumbs show current navigation path"
  artifacts:
    - path: "src/app/(dashboard)/layout.tsx"
      provides: "Dashboard layout with sidebar and topbar"
      min_lines: 30
    - path: "src/components/layout/sidebar.tsx"
      provides: "Navigation sidebar"
      min_lines: 40
    - path: "src/components/layout/topbar.tsx"
      provides: "Top navigation bar"
      min_lines: 30
    - path: "src/components/layout/mobile-drawer.tsx"
      provides: "Mobile slide-out navigation"
      min_lines: 30
    - path: "src/components/theme-toggle.tsx"
      provides: "Dark/light mode toggle"
      contains: "useTheme"
  key_links:
    - from: "src/app/(dashboard)/layout.tsx"
      to: "src/components/layout/sidebar.tsx"
      via: "Sidebar component"
      pattern: "<Sidebar"
    - from: "src/components/layout/user-menu.tsx"
      to: "src/hooks/use-user.ts"
      via: "useLogout hook"
      pattern: "useLogout"
    - from: "src/components/theme-toggle.tsx"
      to: "next-themes"
      via: "useTheme hook"
      pattern: "useTheme"
---

<objective>
Build the dashboard shell with sidebar navigation, top bar, mobile drawer, and visual foundation.

Purpose: Create the authenticated user interface structure that all dashboard pages will use (UX-01, UX-02).
Output: Responsive dashboard layout with dark mode, navigation, user menu, and loading states.
</objective>

<execution_context>
@/Users/gabrielleal/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gabrielleal/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation-authentication/01-RESEARCH.md
@.planning/phases/01-foundation-authentication/01-CONTEXT.md
@.planning/phases/01-foundation-authentication/01-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create base UI components</name>
  <files>
    src/components/ui/button.tsx
    src/components/ui/skeleton.tsx
    src/components/theme-toggle.tsx
    src/hooks/use-mobile.ts
  </files>
  <action>
    Create src/components/ui/button.tsx:
    - Reusable button component with variants:
      - primary (purple accent #8B5CF6)
      - secondary (gray/surface)
      - ghost (transparent hover)
      - destructive (red for delete/logout)
    - Sizes: sm, md, lg
    - Support disabled state, loading state
    - Use cn() for class composition
    - Sharp styling (small/no radius per design decisions)

    Create src/components/ui/skeleton.tsx:
    - Skeleton loading component
    - Animate with pulse effect
    - Support different shapes: line, circle, rect
    - Dark mode compatible (#2d2d2d background with shimmer)

    Create src/components/theme-toggle.tsx ('use client'):
    - Use useTheme from next-themes
    - Toggle button showing sun/moon icon
    - Handle mounted state to prevent hydration mismatch
    - Accessible with proper aria-label

    Create src/hooks/use-mobile.ts:
    - Custom hook to detect mobile viewport
    - Use window.matchMedia for 'lg' breakpoint (1024px)
    - Handle SSR with initial false value
    - Return isMobile boolean
  </action>
  <verify>
    Import and render Button component - styles apply correctly.
    Import and render Skeleton - animation visible.
    Theme toggle changes between dark/light mode.
  </verify>
  <done>
    Base UI components created with proper styling and dark mode support.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create layout components (sidebar, topbar, drawer)</name>
  <files>
    src/components/layout/sidebar.tsx
    src/components/layout/topbar.tsx
    src/components/layout/mobile-drawer.tsx
    src/components/layout/breadcrumbs.tsx
    src/components/layout/user-menu.tsx
  </files>
  <action>
    Create src/components/layout/sidebar.tsx:
    - Always expanded sidebar (not collapsible per CONTEXT)
    - Navigation items with icons (use emoji or simple SVG):
      - Home (dashboard overview)
      - Guilds (guild selection - links to future guild page)
      - Settings (future)
    - Active state highlighting with purple accent
    - Bottom section for legal links (Terms, Privacy)
    - Width: 256px (w-64)
    - Dark surface background (#2d2d2d)

    Create src/components/layout/topbar.tsx:
    - Height: 64px (h-16)
    - Left: Logo/title "Tracking Dashboard" (links to /)
    - Right: Theme toggle, User menu
    - Mobile: Add hamburger menu button (visible on lg:hidden)
    - Border-bottom for separation

    Create src/components/layout/mobile-drawer.tsx ('use client'):
    - Slide-out drawer from left side
    - Overlay backdrop (semi-transparent black)
    - Close on overlay click
    - Close on navigation (link click)
    - Transition animation (translate-x)
    - Trap focus when open for accessibility

    Create src/components/layout/breadcrumbs.tsx:
    - Use usePathname() from next/navigation
    - Generate breadcrumb items from path segments
    - Home > Current Page format
    - Last item not clickable (current page)
    - Responsive: hide on mobile if too long

    Create src/components/layout/user-menu.tsx ('use client'):
    - Dropdown menu triggered by user avatar
    - Show username and avatar (from useUser hook)
    - Menu items:
      - Theme toggle (or move to topbar)
      - Sign out (with quick confirmation per CONTEXT)
    - Use logout hook with confirmation
    - Accessible dropdown with proper keyboard navigation
  </action>
  <verify>
    Render each component in isolation - visual inspection.
    Sidebar shows navigation items with proper styling.
    Topbar displays logo and user menu.
    Mobile drawer opens/closes with animation.
  </verify>
  <done>
    All layout components created with responsive behavior and dark mode styling.
  </done>
</task>

<task type="auto">
  <name>Task 3: Assemble dashboard layout and welcome page</name>
  <files>
    src/app/(dashboard)/layout.tsx
    src/app/(dashboard)/page.tsx
    src/app/(dashboard)/loading.tsx
  </files>
  <action>
    Create src/app/(dashboard)/layout.tsx ('use client'):
    - Flex container for sidebar + main content
    - Desktop: Sidebar visible (hidden lg:block), main content flex-1
    - Mobile: Sidebar hidden, MobileDrawer component
    - State for drawer open/close
    - Structure:
      ```
      <div className="flex h-screen">
        {/* Desktop sidebar */}
        <aside className="hidden lg:block w-64 border-r border-surface">
          <Sidebar />
        </aside>

        {/* Mobile drawer */}
        <MobileDrawer open={drawerOpen} onClose={() => setDrawerOpen(false)}>
          <Sidebar onNavigate={() => setDrawerOpen(false)} />
        </MobileDrawer>

        {/* Main content */}
        <div className="flex-1 flex flex-col overflow-hidden">
          <Topbar onMenuClick={() => setDrawerOpen(true)} />
          <main className="flex-1 overflow-auto p-4 md:p-6">
            <Breadcrumbs />
            {children}
          </main>
        </div>
      </div>
      ```

    Create src/app/(dashboard)/page.tsx:
    - Welcome page for first login (per CONTEXT)
    - Show user's name: "Welcome, {username}!"
    - Guide to next steps: "Select a guild to get started"
    - Link to guild selection (placeholder for Phase 2)
    - Use useUser hook to get current user
    - Handle loading state with skeleton

    Create src/app/(dashboard)/loading.tsx:
    - Full page skeleton loading state
    - Match layout structure
    - Use Skeleton components for content areas
  </action>
  <verify>
    Navigate to / while authenticated (mock cookie for testing):
    - Desktop: Sidebar visible, main content shows welcome
    - Mobile (resize browser): Hamburger menu visible, drawer works
    - Theme toggle switches mode
    - User menu shows logout option
    - Breadcrumbs show "Home"
  </verify>
  <done>
    Dashboard layout complete with sidebar, topbar, mobile drawer, welcome page, and loading state.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Desktop view: Sidebar always visible, 256px wide
2. Mobile view (<1024px): Hamburger menu, slide-out drawer
3. Theme toggle works (dark/light switch)
4. User menu dropdown shows logout option
5. Logout confirmation appears before actual logout
6. Breadcrumbs show current path
7. Loading state uses skeleton components
8. Welcome page displays user name and guidance
9. Dark mode is default, colors match spec (#1a1a1a, #8B5CF6)
</verification>

<success_criteria>
- UX-01: Dark mode dashboard with Discord-style theme
- UX-02: Fully responsive on mobile devices
- Sidebar always expanded (not collapsible to icons)
- Top bar with minimal design (logo left, user right)
- Mobile drawer slides out from hamburger
- Theme toggle functional
- Logout with confirmation dropdown
- Breadcrumbs for navigation context
- Loading skeletons for async content
- Welcome page guides new users
</success_criteria>

<output>
After completion, create `.planning/phases/01-foundation-authentication/01-04-SUMMARY.md`
</output>
