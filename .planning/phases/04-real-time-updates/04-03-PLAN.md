---
phase: 04-real-time-updates
plan: 03
type: execute
wave: 3
depends_on: ["04-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "User sees bot online/offline status indicator that updates in real-time"
    - "Bot status changes reflect within 5 seconds without manual refresh"
    - "User sees last seen timestamp when bot is offline"
    - "Dashboard remains functional when bot is down"
  artifacts: []
  key_links: []
---

<objective>
Verify real-time status updates work correctly across all scenarios.

Purpose: Ensure the SSE implementation meets all Phase 4 success criteria before marking the phase complete.
Output: Verified real-time status system ready for production.
</objective>

<execution_context>
@/Users/gabrielleal/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gabrielleal/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-real-time-updates/04-CONTEXT.md
@.planning/phases/04-real-time-updates/04-01-SUMMARY.md
@.planning/phases/04-real-time-updates/04-02-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Real-time bot status system with SSE:
- SSE proxy route at `/api/guilds/[guildId]/status/stream`
- useSSE hook with exponential backoff reconnection
- useGuildStatusRealtime hook integrating SSE with React Query
- Enhanced BotStatus component with connection states
  </what-built>
  <how-to-verify>
**Start the dev server:**
```bash
npm run dev
```

**Test 1: Initial Connection State**
1. Navigate to a guild detail page (e.g., http://localhost:3000/guilds/[your-guild-id])
2. Observe the bot status indicator in the header area
3. Expected: Shows "Connecting..." briefly, then resolves to Online/Offline state

**Test 2: Status Display (Bot Online)**
1. If bot is online, verify:
   - Green pulsing dot
   - "Online" text in green
   - Subtle pulse animation

**Test 3: Status Display (Bot Offline)**
1. If bot is offline, verify:
   - Red static dot
   - "Offline" text in red
   - "Last seen: X minutes/hours ago" timestamp
   - "Check Discord" suggestion text

**Test 4: Connection Error State**
1. Open browser DevTools > Network tab
2. Block the SSE endpoint (right-click the stream request > Block request URL)
3. Wait ~30 seconds for retry exhaustion
4. Expected: Yellow dot, "Connection lost", "Click to retry"
5. Click the status indicator
6. Expected: Reconnection attempt starts, shows "Connecting..."

**Test 5: Real-Time Updates (if backend supports SSE)**
1. Open DevTools > Network tab
2. Look for `/status/stream` EventStream connection
3. If backend sends events, status should update without page refresh

**Test 6: Dashboard Functionality When Bot Offline**
1. With bot offline (or simulated), navigate between pages
2. Verify all pages load and display data correctly
3. Status indicator should persist showing offline state

**Note:** If backend doesn't have SSE endpoint yet, the system should gracefully fall back to polling. The SSE connection will fail and polling takes over (every 60 seconds).
  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
Phase 4 success criteria (from ROADMAP.md):
- [ ] User sees bot online/offline status indicator that updates in real-time
- [ ] Bot status changes reflect within 5 seconds without manual refresh
- [ ] User sees last seen timestamp when bot is offline
- [ ] Dashboard remains functional when bot is down (independent uptime)
</verification>

<success_criteria>
All Phase 4 success criteria verified by human testing:
- Status indicator displays correctly for all states
- Real-time updates work (or graceful fallback to polling)
- Connection error handling works with manual retry
- Dashboard remains fully functional regardless of bot status
</success_criteria>

<output>
After completion, create `.planning/phases/04-real-time-updates/04-03-SUMMARY.md`
</output>
