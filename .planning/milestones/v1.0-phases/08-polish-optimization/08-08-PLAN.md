---
phase: 08-polish-optimization
plan: 08
type: execute
wave: 3
depends_on: ["08-02", "08-05"]
files_modified:
  - src/components/filters/search-input.tsx
  - src/app/(dashboard)/layout.tsx
  - src/components/forms/add-account-modal.tsx
  - src/components/forms/add-brand-modal.tsx
  - src/components/ui/confirmation-modal.tsx
autonomous: true

must_haves:
  truths:
    - "Ctrl+K / Cmd+K focuses the search input on any page with a search field"
    - "Keyboard shortcuts hook is wired into dashboard layout"
    - "Unsaved changes in add-account/add-brand modals trigger beforeunload warning"
    - "Layout transitions use CSS transitions for smooth responsive reflow"
  artifacts:
    - path: "src/components/filters/search-input.tsx"
      provides: "Search input with data-search-input attribute for keyboard shortcut targeting"
      contains: "data-search-input"
    - path: "src/app/(dashboard)/layout.tsx"
      provides: "Dashboard layout with keyboard shortcuts hook"
      contains: "useKeyboardShortcuts"
  key_links:
    - from: "src/hooks/use-keyboard-shortcuts.ts"
      to: "src/components/filters/search-input.tsx"
      via: "data-search-input attribute"
      pattern: "data-search-input"
    - from: "src/app/(dashboard)/layout.tsx"
      to: "src/hooks/use-keyboard-shortcuts.ts"
      via: "hook call"
      pattern: "useKeyboardShortcuts"
---

<objective>
Wire keyboard shortcuts into dashboard, add data-search-input attribute to search component, integrate unsaved changes warnings into form modals, and add CSS transitions for responsive layout changes.

Purpose: Final UX polish — keyboard accessibility, form safety, and smooth visual transitions.
Output: Working Ctrl+K shortcut, unsaved changes warnings on modals, smooth layout transitions.
</objective>

<execution_context>
@/Users/gabrielleal/.claude/get-shit-done/workflows/execute-plan.md
@/Users/gabrielleal/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-polish-optimization/08-CONTEXT.md
@.planning/phases/08-polish-optimization/08-02-SUMMARY.md
@.planning/phases/08-polish-optimization/08-05-SUMMARY.md

@src/components/filters/search-input.tsx
@src/app/(dashboard)/layout.tsx
@src/components/forms/add-account-modal.tsx
@src/components/forms/add-brand-modal.tsx
@src/hooks/use-keyboard-shortcuts.ts
@src/hooks/use-unsaved-changes.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Wire keyboard shortcuts and search input targeting</name>
  <files>
    src/components/filters/search-input.tsx
    src/app/(dashboard)/layout.tsx
  </files>
  <action>
    1. **Add data-search-input attribute to SearchInput**:
       - In `src/components/filters/search-input.tsx`, add `data-search-input` attribute to the `<input>` element
       - This allows the useKeyboardShortcuts hook to find and focus it via `document.querySelector('[data-search-input]')`
       - No other changes to SearchInput needed

    2. **Wire useKeyboardShortcuts into dashboard layout**:
       - Read `src/app/(dashboard)/layout.tsx` to understand current structure
       - Import `useKeyboardShortcuts` from '@/hooks/use-keyboard-shortcuts'
       - If layout is a Server Component, create a small client wrapper component `KeyboardShortcutsProvider` that calls the hook and renders nothing (return null)
       - Add the provider inside the layout
       - If layout is already a client component, just call useKeyboardShortcuts() directly

    3. **Verify Ctrl+K works**: The hook (from Plan 02) listens for Ctrl+K/Cmd+K and focuses [data-search-input]. With the attribute added and hook wired in, pressing Ctrl+K on any page with SearchInput should focus it.
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - SearchInput has data-search-input attribute
    - Dashboard layout imports and uses useKeyboardShortcuts
    - `grep -r "data-search-input" src/` shows attribute in search-input.tsx
  </verify>
  <done>
    Ctrl+K / Cmd+K focuses search input on any dashboard page with a search field. Keyboard shortcuts hook wired into dashboard layout.
  </done>
</task>

<task type="auto">
  <name>Task 2: Wire unsaved changes and add CSS transitions</name>
  <files>
    src/components/forms/add-account-modal.tsx
    src/components/forms/add-brand-modal.tsx
    src/components/ui/confirmation-modal.tsx
  </files>
  <action>
    1. **Unsaved changes in AddAccountModal**:
       - Import `useUnsavedChanges` from '@/hooks/use-unsaved-changes'
       - Track whether form fields have been modified (dirty state): check if any field value differs from initial/empty
       - Call `useUnsavedChanges(isDirty && isOpen)` — only warn when modal is open AND has changes
       - When modal closes via cancel, reset dirty state

    2. **Unsaved changes in AddBrandModal**:
       - Same pattern as AddAccountModal
       - Track dirty state for brand form fields
       - Call `useUnsavedChanges(isDirty && isOpen)`

    3. **CSS transitions for layout changes** (responsive resizing):
       - In key layout containers (confirmation-modal.tsx or similar shared components), add CSS `transition-all duration-200` classes where layout might change on resize
       - This is a subtle polish — add transition classes to:
         - Modal width/padding changes: `transition-all duration-200 ease-in-out`
         - Grid layout changes: on card grids that switch between 1/2/3 columns, the grid items should transition smoothly
       - Don't add transitions to everything — just to layout containers that visibly change on resize
       - Key target: card grids on accounts/posts pages use `grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3` — adding `transition-all` to the grid container won't help (CSS Grid doesn't animate column count). Instead, focus on modal width and sidebar visibility transitions.

    Note: The unsaved changes warning uses browser's native `beforeunload` dialog (not a custom modal) per research recommendation. This covers tab close, browser refresh, and external navigation. Internal Next.js navigation is not intercepted (App Router limitation).
  </action>
  <verify>
    - `npx tsc --noEmit` passes
    - AddAccountModal and AddBrandModal use useUnsavedChanges
    - Modals track dirty state correctly
    - CSS transitions added to appropriate containers
  </verify>
  <done>
    Form modals warn on unsaved changes via beforeunload. CSS transitions added for smooth layout reflow on resize.
  </done>
</task>

</tasks>

<verification>
- `npx tsc --noEmit` passes
- `npm run build` succeeds
- Ctrl+K focuses search input
- Form modals warn on unsaved changes
- Layout transitions are smooth
</verification>

<success_criteria>
- Pressing Ctrl+K / Cmd+K focuses search input on accounts, posts, etc.
- Attempting to close tab with unsaved form data shows browser warning
- Modal and layout transitions are smooth on resize
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/08-polish-optimization/08-08-SUMMARY.md`
</output>
